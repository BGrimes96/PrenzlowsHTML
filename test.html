<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Prenzlow Meats — Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --pm-red:#c41a1a; --pm-red-dark:#9e1414;
      --ink:#0f172a; --ink-on-red:#ffffff; --muted:#6b7280; --surface:#ffffff;
      --max:1200px;
    }
    *{box-sizing:border-box}
    html{-webkit-text-size-adjust:100%}
    html,body{margin:0;padding:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#fff;color:var(--ink);line-height:1.65}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;height:auto;display:block}

    /* Header / brand */
    header.site-header{background:#fff; position:relative; z-index:2;}
    .header-inner{max-width:var(--max);margin:0 auto;padding:18px 18px 10px}
    .brand{display:flex;justify-content:center}
    .brand img{width:clamp(180px, 28vw, 420px)}

    /* Slogan (no side lines; quotes same color) */
    .slogan-wrap{display:flex;align-items:center;justify-content:center;margin:8px 18px 0}
    .slogan{
      font-weight:1000; letter-spacing:.08em; text-transform:uppercase;
      font-size:clamp(14px,3.2vw,24px); color:var(--pm-red);
      padding:0; border:0; white-space:nowrap; position:relative;
    }
    .slogan::before, .slogan::after{ color:var(--pm-red); font-weight:1000; }
    .slogan::before{content:"“";}
    .slogan::after{content:"”";}

    /* Sections scaffold */
    .section .inner{max-width:var(--max);margin:0 auto;padding:clamp(20px,4vw,56px) 18px}

    /* Lede (red hero) */
    .lede{background:var(--pm-red);color:var(--ink-on-red);text-align:center}
    .lede p{
      margin:0 auto; max-width:1000px;
      font-weight:800; font-size:clamp(18px,2.6vw,28px);
      letter-spacing:.15px; line-height:1.45; padding:16px 0 10px;
    }
    .lede .actions{margin-top:10px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap}
    .btn-white{
      background:#fff; color:var(--pm-red); border:2px solid #fff;
      font-weight:1000; padding:12px 18px; border-radius:12px; min-height:48px;
      display:inline-flex; align-items:center; justify-content:center;
      font-size:clamp(15px,1.9vw,18px);
      transition:background .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease, transform .15s ease;
    }
    /* Keep the HERO button white on hover */
    #heroPickupBtn:hover{ background:#fff; color:var(--pm-red); border-color:#fff; }

    /* Card / What We Do */
    .card{background:#fff;border-radius:14px;border:2px solid #f3f4f6;padding:clamp(22px,3.5vw,40px)}
    .card h2{
      margin:0 0 10px; color:var(--pm-red);
      font-size:clamp(26px,4.4vw,38px); font-weight:1000; text-align:center
    }
    .card .subhead{
      margin:0 auto 18px; max-width:820px; text-align:center;
      color:#374151; font-size:clamp(16px,2.1vw,19px); line-height:1.6;
    }

    /* Grid for left/right boxes */
    .what-grid{ display:grid; grid-template-columns:1fr 1fr; gap:24px; margin:20px auto; max-width:1000px; align-items:stretch; }
    .what-box{ background:#fff; border:1px solid #f3f4f6; border-radius:12px; padding:22px 20px; display:flex; flex-direction:column; min-height:100%; }
    .box-title{ margin:0 0 10px 0; font-weight:900; color:var(--pm-red); font-size:clamp(18px,2.2vw,22px); letter-spacing:.2px; text-align:left; }
    .box-title.center{text-align:center}
    .box-title.long{ max-width:28ch; margin-left:auto; margin-right:auto; line-height:1.35; }
    .what-box p{ margin:10px 0; font-size:clamp(16px,2.1vw,19px); line-height:1.7; color:#111827; text-align:left; }
    .what-box.bold p{ font-weight:800; } /* bolded copy */

    .what-list{ list-style:disc; margin:0; padding-left:1.25rem; font-size:clamp(16px,2.1vw,19px); line-height:1.7; color:#111827; font-weight:700; }
    .what-list li{margin:6px 0}
    .what-list li.spaced{margin-top:14px}
    .what-sub{ list-style:circle; margin:6px 0 0; padding-left:1.25rem; font-weight:600; color:#111827; font-size:clamp(15px,2vw,18px); }

    /* Buttons centered inside each box */
    .box-actions{ margin-top:auto; display:flex; justify-content:center; padding-top:10px; }

    @media(max-width:768px){
      .what-grid{grid-template-columns:1fr}
      .box-title{text-align:left}
      .box-title.center{ text-align:center }
    }

    /* Generic button styles */
    .btn-red, .btn-ghost{
      font-weight:1000; padding:14px 20px; border-radius:14px; min-height:52px;
      display:inline-flex; align-items:center; justify-content:center; font-size:clamp(15px,1.9vw,18px);
      border:2px solid var(--pm-red); text-decoration:none;
      transition:background .15s ease, color .15s ease, border-color .15s ease;
    }
    .btn-red{background:var(--pm-red);color:#fff;border-color:var(--pm-red-dark)}
    .btn-ghost{background:#fff;color:var(--pm-red);border-color:var(--pm-red)}
    /* RED -> WHITE on hover */
    .btn-red:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }
    /* WHITE -> RED on hover */
    .btn-ghost:hover{ background:var(--pm-red); color:#fff; border-color:var(--pm-red-dark); }

    /* ORDER ONLINE (red section) */
    .order-online{ background:var(--pm-red); color:var(--ink-on-red); }
    .order-online .inner{ padding:clamp(28px,6vw,80px) 18px; }
    .order-online h2{
      margin:0 0 14px; text-align:center; font-size:clamp(26px,5vw,42px); font-weight:1000;
    }
    .product-grid{ display:grid; grid-template-columns:repeat(4,1fr); gap:16px; max-width:var(--max); margin:0 auto 16px; }
    .product-card{ background:#fff; color:#111; border-radius:12px; overflow:hidden; border:2px solid #f3f4f6; }
    .product-card img{ width:100%; aspect-ratio: 4 / 3; object-fit:cover }
    .product-card .pcap{ padding:10px; font-weight:800; text-align:center; color:#0f172a; }
    @media(max-width:900px){ .product-grid{ grid-template-columns:repeat(2,1fr); } }
    @media(max-width:520px){ .product-grid{ grid-template-columns:1fr; } }

    /* "Place Order" (SECOND button) — bigger, RED default → WHITE on hover */
    #openCartBtn{
      background:var(--pm-red); color:#fff; border:2px solid var(--pm-red-dark);
      min-height:64px; padding:18px 26px; font-size:clamp(18px,2.2vw,22px); border-radius:16px; font-weight:1000;
      transition:background .15s ease, color .15s ease, border-color .15s ease;
    }
    #openCartBtn:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }

    /* CART DRAWER (denser) */
    .cart-drawer{
      position:fixed; top:0; right:0; height:100vh; width:min(520px, 28vw); max-width:100%;
      background:#fff; color:#0f172a; box-shadow:-16px 0 40px rgba(0,0,0,.25); border-left:3px solid var(--pm-red-dark);
      transform:translateX(100%); transition:transform .28s ease; z-index:1000; display:flex; flex-direction:column;
      font-size:14px;
    }
    .cart-drawer.open{ transform:translateX(0) }
    .cart-header{ padding:8px 10px; background:#fff; border-bottom:1px solid #e5e7eb; }
    .pickup-note{ background:#fff5f5; border:1px solid #fecaca; color:#7f1d1d; padding:8px 10px; border-radius:8px; font-weight:700; font-size:12px; line-height:1.4; }
    .cart-body{ padding:8px 10px; overflow:auto; flex:1 }

    /* hide the minimize arrow until cart is open (only the cart icon shows initially) */
    .cart-drawer:not(.open) .close-handle{ display:none; }

    .cart-msg, .confirm-bar{ display:none; } /* replaced by modal */
    .selector-label{ font-weight:1000; color:var(--pm-red); margin:10px 0 6px; font-size:14px; }

    /* Category groups (five separate selects) — compact */
    .category-group{ border:1px solid #f3f4f6; border-radius:8px; padding:8px; margin-top:8px; }
    .category-group .group-title{ font-weight:900; color:#0f172a; margin:0 0 6px; }
    .item-select{ border:2px solid var(--pm-red); border-radius:8px; padding:8px 10px; font-weight:800; color:#111827; width:auto; max-width:100%; background:#fff; }

    .qty-row{ display:flex; align-items:center; gap:8px; margin-top:10px; flex-wrap:wrap; }
    .qty-row input{ width:110px; border:2px solid #e5e7eb; border-radius:8px; padding:8px 10px; font-weight:800; }
    .qty-note{ font-size:11px; color:#6b7280; }
    .add-btn{ background:var(--pm-red); color:#fff; border:2px solid var(--pm-red-dark); padding:8px 12px; border-radius:10px; font-weight:1000; cursor:pointer; transition:background .15s ease, color .15s ease, border-color .15s ease; }
    .add-btn:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }

    .cart-items{ margin-top:10px; display:grid; gap:6px }
    .cart-item{ display:grid; grid-template-columns:1fr auto auto auto; gap:6px; align-items:center; border:1px solid #e5e7eb; border-radius:8px; padding:6px 8px; background:#fafafa; font-weight:700; }
    .cart-item .remove{ background:transparent; border:0; color:#991b1b; font-size:18px; cursor:pointer; font-weight:900; }

    .customer-fields{ margin-top:12px; display:grid; grid-template-columns:1fr 1fr; gap:8px; }
    .field label{ display:block; font-weight:900; margin-bottom:4px; color:#0f172a; font-size:13px; }
    .field input{ width:100%; border:2px solid #e5e7eb; border-radius:8px; padding:8px 10px; font-weight:700; font-size:14px; }
    @media(max-width:560px){ .customer-fields{ grid-template-columns:1fr; } }

    .cart-total{ margin-top:10px; border-top:2px dashed #e5e7eb; padding-top:8px; font-weight:1000; font-size:16px; display:flex; justify-content:space-between; align-items:center; }
    .checkout-row{ margin-top:6px; display:flex; gap:8px; }
    .checkout-btn{ background:var(--pm-red); color:#fff; border:2px solid var(--pm-red-dark); padding:10px 14px; border-radius:10px; font-weight:1000; flex:1; text-align:center; cursor:pointer; transition:background .15s ease, color .15s ease, border-color .15s ease; }
    .checkout-btn:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }

    /* Close handle (inside cart) = minimize (arrow) */
    .close-handle{
      position:absolute; top:50%; left:-44px; transform:translateY(-50%);
      width:44px; height:88px; background:var(--pm-red); color:#fff; border:0;
      border-radius:12px 0 0 12px; box-shadow:-4px 0 12px rgba(0,0,0,.25);
      display:flex; align-items:center; justify-content:center; cursor:pointer;
      font-size:24px; font-weight:900; transition:background .15s ease, color .15s ease;
    }
    .close-handle:hover{ background:#fff; color:var(--pm-red); }

    /* ALWAYS-VISIBLE right-side open handle = CART icon */
    .open-handle{
      position:fixed; top:50%; right:0; transform:translateY(-50%);
      height:96px; width:56px; border-radius:12px 0 0 12px; background:var(--pm-red); color:#fff;
      display:flex; align-items:center; justify-content:center; cursor:pointer;
      box-shadow:0 8px 24px rgba(0,0,0,.25); z-index:999; border:0;
      transition:background .15s ease, color .15s ease;
    }
    .open-handle svg{ width:28px; height:28px; display:block; pointer-events:none; }
    .open-handle:hover{ background:#fff; color:var(--pm-red); }

    @media(max-width:900px){ .cart-drawer{ width:90vw } }

    /* CTA WHITE (bottom) */
    .cta-white{ background:#fff; color:var(--ink); border-top:2px solid #f3f4f6; }
    .cta-white .block{max-width:900px; margin:0 auto; text-align:center;}
    .cta-white h2{ margin:0; font-size:clamp(24px,4.8vw,40px); font-weight:1000; }
    .cta-actions{ display:flex; justify-content:center; gap:16px; margin-top:18px; flex-wrap:wrap; max-width:720px; margin-left:auto; margin-right:auto; }
    .cta-actions a{ flex:1 1 260px; }
    
    /* Disable body scroll when cart open on mobile */
    body.cart-open-mobile .site-header{ pointer-events:none; filter:grayscale(100%) opacity(.45); }
    body.no-scroll{ overflow:hidden; }

    /* Centered MODAL */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(0,0,0,.45); display:none;
      align-items:center; justify-content:center; z-index:2000;
    }
    .modal{
      background:#fff; border:2px solid var(--pm-red); border-radius:12px;
      width:min(520px, 92vw); padding:16px; text-align:center;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .modal h3{ margin:0 0 8px; font-size:18px; color:var(--pm-red); }
    .modal p{ margin:0 0 14px; color:#111827; }
    .modal-actions{ display:flex; gap:10px; justify-content:center; }
    .modal-btn{
      font-weight:1000; padding:10px 14px; border-radius:10px; border:2px solid var(--pm-red);
      background:#fff; color:var(--pm-red); cursor:pointer;
      transition:background .15s ease, color .15s ease, border-color .15s ease;
    }
    .modal-btn.primary{ background:var(--pm-red); color:#fff; border-color:var(--pm-red-dark); }
    .modal-btn:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }
    .modal-btn.primary:hover{ background:#fff; color:var(--pm-red); border-color:var(--pm-red); }
    .modal-close-x{
      position:absolute; top:10px; right:14px; font-weight:900; background:none; border:0; font-size:22px; cursor:pointer; color:#991b1b;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="header-inner">
      <div class="brand">
        <img src="/prenzlowmeats.png" alt="PRENZLOW MEATS — Since 1920">
      </div>
      <div class="slogan-wrap">
        <span class="slogan">We Bring The Country To Your Table</span>
      </div>
    </div>
    <div id="navMount" data-include="/navigation.html">[loading navigation…]</div>
  </header>

  <!-- Hero -->
  <section class="section lede" aria-label="Hero">
    <div class="inner">
      <p>We’ve been proudly serving customers for over 100 years with hand-crafted meats and Old World tradition.</p>
      <div class="actions">
        <button class="btn-white" id="heroPickupBtn" type="button">Place An Order for Pickup</button>
      </div>
    </div>
  </section>

  <!-- What We Do -->
  <section class="section" aria-label="What We Do">
    <div class="inner">
      <article class="card">
        <h2>What We Do</h2>
        <p class="subhead">Old-World craftsmanship, modern food-safety, and service you can trust.</p>

        <div class="what-grid">
          <!-- LEFT -->
          <div class="what-box bold">
            <h3 class="box-title center long">
              We Offer Retail Product that includes Specialty Smoked Meats and Premium Cuts
            </h3>
            <p>Our hams, lunch meats and sausage are hand crafted without using any manmade chemicals.</p>
            <p>The traditional recipes and processing methods we use have not changed for three generations.</p>
            <p>When you try our meats, you can be confident that the healthy Old-World traditions will be evident with every bite.</p>
            <p>Thank you for your patronage and we welcome all comments and feedback.</p>
            <div class="box-actions">
              <a class="btn-red" href="/products.html">View Our Products</a>
            </div>
          </div>

          <!-- RIGHT -->
          <div class="what-box">
            <h3 class="box-title">Premium Cuts and Specialty Smoked Meats</h3>
            <ul class="what-list">
              <li>Professional Customized Meat Processing</li>
              <li class="spaced">
                We Offer Retail Product that includes Specialty Smoked Meats and Premium Cuts
                <ul class="what-sub">
                  <li>Specialty Cut Hams</li>
                  <li>Specialty Cut Lunch Meats</li>
                  <li>Specialty Cut Sausage</li>
                  <li>Specialty Cut Steaks</li>
                  <li>Specialty Ground Hamburger By The Pound</li>
                </ul>
              </li>
            </ul>
            <div class="box-actions">
              <a class="btn-ghost" href="/contact-us/">Contact Us</a>
            </div>
          </div>
        </div>
      </article>
    </div>
  </section>

  <!-- ORDER ONLINE -->
  <section class="section order-online" aria-label="Order Online">
    <div class="inner">
      <h2>Order Online</h2>

      <div class="product-grid">
        <div class="product-card"><img src="/product1.png" alt="Featured product 1"><div class="pcap">Featured Product</div></div>
        <div class="product-card"><img src="/product2.png" alt="Featured product 2"><div class="pcap">Featured Product</div></div>
        <div class="product-card"><img src="/product3.png" alt="Featured product 3"><div class="pcap">Featured Product</div></div>
        <div class="product-card"><img src="/product4.png" alt="Featured product 4"><div class="pcap">Featured Product</div></div>
      </div>

      <div style="text-align:center">
        <button id="openCartBtn" type="button">Place Order</button>
      </div>
    </div>
  </section>

  <!-- CTA (white) -->
  <section class="section cta-white" aria-label="Helpful Links">
    <div class="inner">
      <div class="block">
        <h2>Ready to Start an Order?</h2>
        <div class="cta-actions">
          <a class="btn-red" href="/faq/">Read the FAQ</a>
          <a class="btn-ghost" href="/contact-us/">Contact Us</a>
        </div>
      </div>
    </div>
  </section>

  <!-- ALWAYS-VISIBLE right-side open handle (CART ICON to open) -->
  <button class="open-handle" id="openHandle" type="button" aria-label="Open cart" title="Open cart">
    <!-- Simple cart icon (stroke follows currentColor) -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M3 4h2l2 10h11l3-8H6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path>
      <circle cx="9" cy="20" r="2" fill="currentColor"></circle>
      <circle cx="18" cy="20" r="2" fill="currentColor"></circle>
    </svg>
  </button>

  <!-- Cart Drawer -->
  <aside class="cart-drawer" id="cartDrawer" aria-hidden="true" aria-label="Cart">
    <!-- Arrow to MINIMIZE (only shows when open) -->
    <button class="close-handle" id="closeHandle" type="button" title="Hide cart">⟩</button>

    <div class="cart-header">
      <div class="pickup-note">
        By placing an order, your order will be available for pickup at<br>
        <strong>635 240th Street, Waterloo, NE 68069</strong> at <strong>2 PM the Next Day</strong>.
      </div>
    </div>

    <div class="cart-body">
      <!-- replaced inline alerts with modal -->
      <div id="categoryMenus"></div>

      <div class="qty-row">
        <label for="qty" style="font-weight:900">Pounds:</label>
        <input id="qty" type="number" min="1" max="100" value="1" inputmode="numeric" />
        <button class="add-btn" id="addItemBtn" type="button">Add Item</button>
        <div class="qty-note">Up to 100 Pounds</div>
      </div>

      <div class="cart-items" id="cartItems" aria-live="polite"></div>

      <div class="customer-fields">
        <div class="field">
          <label for="custName">Name <span aria-hidden="true" style="color:#c41a1a">*</span></label>
          <input id="custName" type="text" placeholder="Your full name" required />
        </div>
        <div class="field">
          <label for="custPhone">Phone <span aria-hidden="true" style="color:#c41a1a">*</span></label>
          <input id="custPhone" type="tel" placeholder="e.g., 402-555-1234" required />
        </div>
      </div>

      <div class="cart-total">
        <span>Total</span>
        <span id="cartTotal">$0.00</span>
      </div>
      <div class="checkout-row">
        <button class="checkout-btn" type="button" id="checkoutBtn" title="Proceed to pickup instructions">Checkout</button>
      </div>
    </div>
  </aside>

  <!-- MODAL (alerts & confirms) -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-live="assertive">
    <div class="modal" role="document">
      <button class="modal-close-x" id="modalCloseX" aria-label="Close">×</button>
      <h3 id="modalTitle">Attention</h3>
      <p id="modalText">Message</p>
      <div class="modal-actions">
        <button class="modal-btn" id="modalCancel" type="button">No</button>
        <button class="modal-btn primary" id="modalOk" type="button">OK</button>
      </div>
    </div>
  </div>

  <!-- Shared footer include -->
  <div id="footerMount" data-include="/sitemap-footer.html">[loading footer…]</div>

  <script>
    /* ===== include helper (nav + footer) ===== */
    (function () {
      async function tryFetch(url) {
        const bust = (url.includes('?') ? '&' : '?') + 'v=' + Date.now();
        const res = await fetch(url + bust, { cache: 'no-store' });
        if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
        return await res.text();
      }
      async function inject(selector) {
        const nodes = document.querySelectorAll(selector);
        for (const mount of nodes) {
          const requested = mount.getAttribute('data-include');
          const candidates = [requested, './' + (requested||'').replace(/^\//,''), (requested||'')].filter(Boolean);
          let loaded = false;
          for (const href of candidates) {
            try {
              const html = await tryFetch(href);
              mount.outerHTML = html;
              loaded = true; break;
            } catch (e) { console.warn('[include] failed', href, e.message); }
          }
          if (!loaded) {
            mount.textContent = 'Section failed to load.';
            mount.style.color = '#b91c1c';
            mount.style.padding = '8px 12px';
            mount.style.fontWeight = '700';
            mount.style.border = '2px solid #fecaca';
            mount.style.borderRadius = '10px';
            mount.style.background = '#fff1f2';
          }
        }
      }
      document.addEventListener('DOMContentLoaded', () => inject('[data-include]'));
    })();

    /* ===== Helpers ===== */
    const isMobile = () => window.matchMedia('(max-width: 768px)').matches;
    function setMobileNavDisabled(disabled){
      if (disabled && isMobile()){
        document.body.classList.add('cart-open-mobile','no-scroll');
      } else {
        document.body.classList.remove('cart-open-mobile','no-scroll');
      }
    }

    // Modal helpers
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalTitle = document.getElementById('modalTitle');
    const modalText = document.getElementById('modalText');
    const modalOk = document.getElementById('modalOk');
    const modalCancel = document.getElementById('modalCancel');
    const modalCloseX = document.getElementById('modalCloseX');
    let modalOkHandler = null;

    function closeModal(){ modalBackdrop.style.display='none'; modalOk.onclick = null; modalCancel.onclick = null; }
    function openAlert(message, title='Attention'){
      modalTitle.textContent = title;
      modalText.textContent = message;
      modalBackdrop.style.display='flex';
      modalCancel.style.display='none';
      modalOk.textContent = 'OK';
      modalOk.onclick = closeModal;
    }
    function openConfirm(message, onConfirm, title='Please Confirm'){
      modalTitle.textContent = title;
      modalText.textContent = message;
      modalBackdrop.style.display='flex';
      modalCancel.style.display='inline-flex';
      modalOk.textContent = 'Yes';
      modalCancel.textContent = 'No';
      modalOk.onclick = ()=>{ closeModal(); onConfirm && onConfirm(); };
      modalCancel.onclick = closeModal;
    }
    modalCloseX.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', (e)=>{ if (e.target === modalBackdrop) closeModal(); });

    /* ===== Catalog (5 categories) ===== */
    const CATALOG = {
      "Beef & Steak":[
        {key:"filet_mignon", label:"Filet Mignon", price:36.00},
        {key:"minute_steak", label:"Minute Steak", price:9.65},
        {key:"new_york_strip", label:"New York Strip", price:18.65},
        {key:"ribeye_steak", label:"Ribeye Steak", price:19.00},
        {key:"beef_stew_meat", label:"Beef Stew Meat", price:8.00},
        {key:"t_bone_steak", label:"T-Bone Steak", price:14.95},
        {key:"top_sirloin_steak", label:"Top Sirloin Steak", price:14.00},
        {key:"arm_roast", label:"Arm Roast", price:7.25},
        {key:"chuck_roast", label:"Chuck Roast", price:7.35},
        {key:"dried_beef", label:"Dried Beef", price:12.00},
        {key:"chunk_summer_sausage", label:"Chunk Summer Sausage", price:6.25},
        {key:"sliced_summer_sausage", label:"Sliced Summer Sausage", price:6.75},
        {key:"chunk_jalapeno_summer_sausage", label:"Chunk Jalapeño Summer Sausage", price:6.75},
        {key:"beef_bacon", label:"Beef Bacon", price:8.00},
        {key:"ground_beef", label:"Ground Beef", price:7.60},
        {key:"beef_patties_13", label:"Beef Patties #13", price:9.60},
        {key:"beef_prime_rib", label:"Beef Prime Rib", price:19.00},
        {key:"beef_spare_ribs", label:"Beef Spare Ribs", price:5.65}
      ],
      "Pork & Bacon":[
        {key:"fresh_pork_chops", label:"Fresh Pork Chops", price:7.20},
        {key:"smoked_pork_chops", label:"Smoked Pork Chops", price:8.60},
        {key:"pork_shoulder_roast", label:"Pork Shoulder Roast", price:6.15},
        {key:"bratwurst_links", label:"Bratwurst Links", price:6.00},
        {key:"fresh_fry_sausage_link", label:"Fresh Fry Sausage Link", price:6.00},
        {key:"smoked_fry_sausage_link", label:"Smoked Fry Sausage Link", price:6.25},
        {key:"mild_italian_sausage_links", label:"Mild Italian Sausage Links", price:6.00},
        {key:"smoked_polish_sausage_links", label:"Smoked Polish Sausage Links", price:6.00},
        {key:"ground_pork_breakfast_sausage", label:"Ground Pork Breakfast Sausage", price:4.00},
        {key:"pork_breakfast_sausage_links", label:"Pork Breakfast Sausage Links", price:5.25},
        {key:"smokies_pack", label:"Smokies (Pack)", price:6.00},
        {key:"smoked_weiners_links", label:"Smoked Weiners Links", price:8.00},
        {key:"smoked_pork_bacon", label:"Smoked Pork Bacon", price:7.85},
        {key:"smoked_pork_bacon_ends", label:"Smoked Pork Bacon Ends", price:6.75},
        {key:"ground_pork", label:"Ground Pork", price:3.15},
        {key:"pork_sausage_patties", label:"Pork Sausage Patties", price:4.50},
        {key:"pork_baby_back_ribs", label:"Pork Baby Back Ribs", price:7.40},
        {key:"pork_ham_sandwich_slices", label:"Pork Ham Sandwich Slices", price:5.70},
        {key:"pork_hocks_smoked", label:"Pork Hocks Smoked", price:4.50}
      ],
      "Jerky/Snack Sticks":[
        {key:"teriyaki_jerky_1lb", label:"Teriyaki Jerky (1 lb Pack)", price:26.00},
        {key:"teriyaki_jerky_bits_1lb", label:"Teriyaki Jerky Bits (1 lb Pack)", price:26.00},
        {key:"teriyaki_jerky_sticks", label:"Teriyaki Jerky Pack, Sticks", price:26.00},
        {key:"smoked_beef_stick", label:"Smoked Beef Stick (1 Stick)", price:26.00}
      ],
      "Cheeses":[
        {key:"white_american_cheese", label:"White American Cheese", price:7.80},
        {key:"yellow_american_cheese", label:"Yellow American Cheese", price:7.80}
      ],
      "Spices":[
        {key:"synders_prime_rib_roast_seasoning", label:"Synders Prime Rib and Roast Seasoning", price:5.50}
      ]
    };

    /* ===== Cart logic ===== */
    const drawer = document.getElementById('cartDrawer');
    const openHandle = document.getElementById('openHandle');
    const closeHandle = document.getElementById('closeHandle');
    const openCartBtn = document.getElementById('openCartBtn');
    const heroPickupBtn = document.getElementById('heroPickupBtn');
    const qtyInput = document.getElementById('qty');
    const addItemBtn = document.getElementById('addItemBtn');
    const cartItemsEl = document.getElementById('cartItems');
    const cartTotalEl = document.getElementById('cartTotal');
    const checkoutBtn = document.getElementById('checkoutBtn');
    const custName = document.getElementById('custName');
    const custPhone = document.getElementById('custPhone');
    const menusMount = document.getElementById('categoryMenus');

    let lastSelectedKey = null;
    let cart = [];

    function currency(n){ return '$' + n.toFixed(2); }

    function openCart(){
      drawer.classList.add('open');
      drawer.setAttribute('aria-hidden','false');
      openHandle.style.display = 'none';
      setMobileNavDisabled(true);
    }
    function hideCart(){
      drawer.classList.remove('open');
      drawer.setAttribute('aria-hidden','true');
      openHandle.style.display = 'flex';
      setMobileNavDisabled(false);
    }

    /* Build five separate category dropdowns */
    function buildCategoryMenus(){
      menusMount.innerHTML = '';
      Object.entries(CATALOG).forEach(([cat, items])=>{
        const wrap = document.createElement('div');
        wrap.className = 'category-group';
        const title = document.createElement('div');
        title.className = 'group-title';
        title.textContent = cat;

        const select = document.createElement('select');
        select.className = 'item-select';

        // First option shows the MENU TITLE (no "Select an item from...")
        const first = document.createElement('option');
        first.value = '';
        first.disabled = true; first.selected = true; /* visible title */
        first.textContent = cat;
        select.appendChild(first);

        items.forEach(item=>{
          const opt = document.createElement('option');
          opt.value = item.key;
          opt.dataset.price = item.price != null ? String(item.price) : '';
          const priceText = (item.price != null) ? ` — $${item.price.toFixed(2)}/LB` : ' — Price unavailable';
          opt.textContent = `${item.label}${priceText}`;
          select.appendChild(opt);
        });

        select.addEventListener('change', ()=>{ lastSelectedKey = select.value || null; });
        wrap.appendChild(title); wrap.appendChild(select);
        menusMount.appendChild(wrap);
        sizeDropdownToContent(select);
      });
    }

    function findItemByKey(key){
      for (const items of Object.values(CATALOG)){
        const f = items.find(i=>i.key===key);
        if (f) return f;
      }
      return null;
    }

    // Size a dropdown to its longest option (+ padding)
    function sizeDropdownToContent(select){
      if (!select) return;
      const span = document.createElement('span');
      span.style.visibility = 'hidden';
      span.style.position = 'absolute';
      span.style.whiteSpace = 'nowrap';
      const cs = getComputedStyle(select);
      span.style.font = cs.font;
      document.body.appendChild(span);
      let max = 0;
      for (const opt of select.options){ span.textContent = opt.text; max = Math.max(max, span.offsetWidth); }
      document.body.removeChild(span);
      select.style.width = Math.ceil(max + 40) + 'px';
    }

    /* Open/close triggers */
    openCartBtn?.addEventListener('click', openCart);
    heroPickupBtn?.addEventListener('click', openCart);
    openHandle?.addEventListener('click', openCart);        // CART ICON opens cart
    closeHandle?.addEventListener('click', hideCart);       // ARROW minimizes cart

    /* Add item handler (works with any of the five selects) */
    addItemBtn?.addEventListener('click', ()=>{
      // If no "lastSelectedKey", try to find any select with a chosen value
      if (!lastSelectedKey){
        const chosen = Array.from(document.querySelectorAll('#categoryMenus select')).find(s => s.value);
        if (chosen) lastSelectedKey = chosen.value;
      }
      if (!lastSelectedKey){ openAlert('Please select a product from any category.'); return; }
      const item = findItemByKey(lastSelectedKey);
      if (!item){ openAlert('Selected item not found.'); return; }
      if (item.price == null){ openAlert('This item does not have a price yet. Please call for pricing or choose another item.'); return; }

      let lbs = parseInt(qtyInput.value||'1', 10);
      if (isNaN(lbs) || lbs < 1) lbs = 1;
      if (lbs > 100) lbs = 100;

      if (lbs > 10){
        openConfirm(`Did you mean to type in (${lbs}) amount of pounds? If yes, add it to cart, if not, do not add it to cart.`, ()=>{
          addOrUpdateCartItem(item.key, item.label, item.price, lbs);
        });
        return;
      }
      addOrUpdateCartItem(item.key, item.label, item.price, lbs);
    });

    function addOrUpdateCartItem(key, label, price, lbs){
      const existing = cart.find(it => it.key === key);
      if (existing){ existing.lbs = Math.min(100, existing.lbs + lbs); }
      else { cart.push({ key, label, price, lbs }); }
      renderCart();
    }
    function removeFromCart(idx){
      cart.splice(idx,1);
      renderCart();
    }
    function computeTotal(){ return cart.reduce((sum,it)=> sum + (it.price * it.lbs), 0); }

    function renderCart(){
      const cartItemsEl = document.getElementById('cartItems');
      const cartTotalEl = document.getElementById('cartTotal');
      cartItemsEl.innerHTML = '';
      cart.forEach((it, idx)=>{
        const row = document.createElement('div');
        row.className = 'cart-item';
        const name = document.createElement('div'); name.textContent = it.label;
        const lbs = document.createElement('div'); lbs.textContent = it.lbs + ' lb' + (it.lbs>1?'s':'');
        lbs.setAttribute('aria-label','Quantity in pounds');
        const price = document.createElement('div'); price.textContent = currency(it.price * it.lbs);
        const remove = document.createElement('button'); remove.className = 'remove'; remove.type = 'button'; remove.title = 'Remove item'; remove.textContent = '×'; remove.addEventListener('click', ()=> removeFromCart(idx));
        row.appendChild(name); row.appendChild(lbs); row.appendChild(price); row.appendChild(remove);
        cartItemsEl.appendChild(row);
      });
      cartTotalEl.textContent = currency(computeTotal());
    }

    /* Checkout validation via modal */
    function validPhone(p){ const digits = (p||'').replace(/\D/g,''); return digits.length >= 7; }
    checkoutBtn?.addEventListener('click', ()=>{
      if (!custName.value.trim()){ openAlert('Please enter your name.'); custName.focus(); return; }
      if (!validPhone(custPhone.value)){ openAlert('Please enter a valid phone number.'); custPhone.focus(); return; }
      if (cart.length === 0){ openAlert('Your cart is empty.'); return; }
      openAlert('Thanks! Your pickup will be ready tomorrow at 2 PM at 635 240th Street, Waterloo, NE 68069.', 'Order Received');
    });

    /* Keyboard: Esc closes modal or hides cart */
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape'){
        if (modalBackdrop.style.display === 'flex') { closeModal(); return; }
        if (drawer.classList.contains('open')) hideCart();
      }
    });

    /* Init */
    window.addEventListener('DOMContentLoaded', ()=>{
      buildCategoryMenus();
    });
  </script>
</body>
</html>
